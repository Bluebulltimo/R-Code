#Code for Creating Partial Least Squares Analysis Using Caret

#Create Model and View Results
library(caret)
library(mlbench)
data(Sonar)
set.seed(107)
inTrain <- createDataPartition(y = Sonar$Class, p = 0.75, list = FALSE)
training <- Sonar[inTrain, ]
testing <- Sonar[-inTrain, ]
ctrl <- trainControl(method = 'repeatedcv', repeats = 3, classProbs = TRUE, summaryFunction = twoClassSummary)
plsFit <- train(Class~. , data = training, method = 'pls', tuneLength = 15, trControl = ctrl, metric = 'ROC', preProc = c('center', 'scale'))
plsFit
plot(plsFit)

#Predict New Samples
plsClasses <- predict(plsFit, newdata = testing)
str(plsClasses)
plsProbs <- predict(plsFit, newdata = testing, type = 'prob')
head(plsProbs)

#Create Confusion Matrix
confusionMatrix(data = plsClasses, testing$Class)

